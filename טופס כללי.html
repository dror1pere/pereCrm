<!DOCTYPE html>
<html lang="he">
  <head>
    <meta charset="UTF-8">
    <title>×¤×¨×</title>

    <!-- ğŸ¨ ×¢×™×¦×•×‘ ×‘×¡×™×¡×™ ×©×œ ×”×˜×•×¤×¡ -->
    <style>
      <?!= include("×¢×™×¦×•×‘ ×˜×•×¤×¡ ×œ×§×•×— ×—×“×©") ?>
    </style>

    <!-- ğŸ“¦ ×¡×›××ª JSON ×©× ×‘×—×¨×” ×“×™× ×××™×ª -->
    <?!= include(dynamicSchema) ?>

    <!-- ğŸ§  ×§×•×“ JS ××¨×•×›×– -->
    <script>
      <?!= include("×˜×¢×™× ×ª_×¡×›××•×ª") ?>
      <?!= include("×‘× ×™×™×ª ×˜×•×¤×¡") ?>
      <?!= include("×›×œ×œ×™ - ×”×•×“×¢×•×ª ×‘×¨××© ×”×˜×•×¤×¡") ?>
      <?!= include("×›×œ×œ×™ - ×”×•×“×¢×•×ª ×œ×©×“×” ×‘×˜×•×¤×¡") ?>
      <?!= include("× ×™×”×•×œ × ×ª×•× ×™ ×”×˜×•×¤×¡ - ×§×•× ×˜×§×¡×˜ + ×ª×§×™× ×•×ª") ?>
      <?!= include("×œ×§×•×— ×—×“×© - ×˜×¢×™× ×ª × ×ª×•× ×™×") ?>
    </script>
  </head>
  <body>

    <!-- ğŸ§± ×©×œ×“ ×˜×•×¤×¡ ×‘×¡×™×¡×™ -->
    <?!= include("×©×œ×“ ×©×œ ×˜×•×¤×¡") ?>

    <!-- ğŸ§© ×§×•××¤×•× × ×˜×•×ª -->
    <?!= include("×§×•××¤×•× × ×˜×•×ª ×©×“×•×ª") ?>
    <?!= include("×§×•××¤×•× × ×˜×•×ª ×›×¤×ª×•×¨×™×") ?>

    <!-- ğŸš€ ×”×¤×¢×œ×ª ×‘× ×™×™×ª ×”×˜×•×¤×¡ + ×˜×¢×™× ×ª × ×ª×•× ×™× ××”×©×¨×ª ×œ×¤×™ ×”×¡×›××” -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const schema = loadSchemaFromDOM("schema-dynamic");

        if (!schema) {
          showGlobalErrorMessage("âŒ ×œ× × ×™×ª×Ÿ ×œ×˜×¢×•×Ÿ ××ª ×”×¡×›××”.");
          return;
        }

        renderForm(schema, "form-body");

        // ğŸ§  ×˜×¢×™× ×ª × ×ª×•× ×™× ××”×©×¨×ª ×œ×¤×™ ×©× ×”×¡×›××”
        if (schema.title === "×¤×ª×™×—×ª ×œ×§×•×— ×—×“×©") {
          console.log("ğŸ“¡ ×˜×¢×™× ×ª × ×ª×•× ×™× ××”×©×¨×ª ×œ×˜×•×¤×¡: ×œ×§×•×— ×—×“×©");

          // â³ ×”×¦×’×ª overlay ××§×¦×•×¢×™ ×¢× ×˜×§×¡×˜ ×“×™× ×××™
          updateLoadingOverlayText("â³ ×˜×•×¢×Ÿ × ×ª×•× ×™× ××”×©×¨×ª...");
          showLoadingOverlay();

          // ğŸ“¡ ×§×¨×™××” ×œ×©×¨×ª
          google.script.run
            .withSuccessHandler(handleFormData)
            .processCustomerForm();
        }

        // ×‘×¢×ª×™×“: × ×™×ª×Ÿ ×œ×”×•×¡×™×£ else if ×œ×˜×¤×¡×™× × ×•×¡×¤×™×
      });
    </script>

  </body>
</html>
